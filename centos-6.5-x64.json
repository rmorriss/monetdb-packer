{
	"builders": [
		{
			"type": "docker",
			"image": "centos",
			"export_path": "output-docker"
		},
		{
			"type": "virtualbox-iso",
			"http_directory": "configs",
			"boot_command": ["<tab> linux ks=http://{{ .HTTPIP }}:{{ .HTTPPort }}/centos.cfg<enter><wait>"],
			"boot_wait": "20s",
			"shutdown_command": "shutdown -h now",
			"guest_os_type": "Fedora_64",
			"iso_checksum": "f9d84907d77df62017944cb23cab66305e94ee6ae6c1126415b81cc5e999bdd0",
			"iso_checksum_type": "sha256",
			"iso_url": "http://ftp.nluug.nl/ftp/pub/os/Linux/distr/CentOS/6.5/isos/x86_64/CentOS-6.5-x86_64-minimal.iso",
			"ssh_password": "monetdb",
			"ssh_username": "root",
			"ssh_wait_timeout": "20m",
			"hard_drive_interface": "sata",
			"vboxmanage": [
				["modifyvm", "{{.Name}}", "--memory", "4096"],
				["modifyvm", "{{.Name}}", "--cpus", "2"],
				["modifyvm", "{{.Name}}", "--chipset", "ich9"],
				["modifyvm", "{{.Name}}", "--hwvirtex", "on"],
				["modifyvm", "{{.Name}}", "--pae", "on"],
				["modifyvm", "{{.Name}}", "--nestedpaging", "on"],
				["modifyvm", "{{.Name}}", "--clipboard", "bidirectional"],
				["modifyvm", "{{.Name}}", "--usb", "on"],
				["modifyvm", "{{.Name}}", "--usbehci", "on"],
				["modifyvm", "{{.Name}}", "--natpf1", "guestssh,tcp,,2222,,22"],
				["storagectl", "{{.Name}}", "--name", "SATA Controller", "--hostiocache", "on"]
			],
			"vboxmanage_post": [
				["modifyvm", "{{.Name}}", "--memory", "2048"]
			],
			"export_opts": ["--vsys", "0", "--vendor", "'MonetDB Solutions'", "--vendorurl", "https://monetdbsolutions.com"],
			"vm_name": "MonetDB+R Analytical Database Sandbox"
		},
		{
			"type": "amazon-ebs",
			"region": "eu-west-1",
			"source_ami": "ami-2918e35e",
			"instance_type": "m3.medium",
			"ssh_username": "ec2-user",
			"ami_name": "MonetDB-{{timestamp}}"
		}
	],
	"provisioners": [
		{
			"type": "file",
			"source": "scripts/user-setup.sh",
			"destination": "~/user-setup.sh"
		},
		{
			"type": "file",
			"source": "scripts/load-voc-data.sh",
			"destination": "~/load-voc-data.sh"
		},
		{
			"type": "file",
			"source": "scripts/ifup-local.sh",
			"destination": "~/ifup-local"
		},
		{
			"type": "file",
			"source": "scripts/monetdbshell.sh",
			"destination": "~/monetdbshell.sh"
		},
		{
			"type": "file",
			"source": "scripts/rshell.sh",
			"destination": "~/rshell.sh"
		},
		{
			"type": "file",
			"source": "scripts/monetdbd.service",
			"destination": "~/monetdbd.service"
		},
		{
			"type": "file",
			"source": "configs/rserver.conf",
			"destination": "~/rserver.conf"
		},
		{
			"type": "shell",
			"script": "provisioners/0-base-provisions.sh",
			"only": ["virtualbox-iso"]
		},
		{
			"type": "shell",
			"inline": [ "reboot && sleep 10" ],
			"only": ["virtualbox-iso"]
		},
		{
			"type": "shell",
			"script": "provisioners/0-extra-base-provisions-epel.sh",
			"only": ["virtualbox-iso", "docker"],
			"pause_before": "30s"
		},
		{
			"type": "shell",
			"script": "provisioners/1-package-install-epel.sh"
		},
		{
			"type": "shell",
			"script": "provisioners/2-ftp-setup.sh"
		},
		{
			"type": "shell",
			"script": "provisioners/3-user-setup.sh"
		},
		{
			"type": "shell",
			"script": "provisioners/4-0-open-ports-epel.sh",
			"only": ["virtualbox-iso", "docker"]
		},
		{
			"type": "shell",
			"script": "provisioners/4-monetdb-setup-epel.sh"
		},
		{
			"type": "shell",
			"script": "provisioners/5-r-setup.sh"
		},
		{
			"type": "shell",
			"script": "provisioners/6-user-shell-setup.sh"
		},
		{
			"type": "shell",
			"script": "provisioners/97-set-motd.sh",
			"only": ["virtualbox-iso", "docker"]
		},
		{
			"type": "shell",
			"script": "provisioners/98-install-virtualbox-guest-additions.sh",
			"only": ["virtualbox-iso"]
		},
		{
			"type": "shell",
			"script": "provisioners/99-clean-up.sh"
		}
	]
}
